---
// 1. Importamos las utilidades de traducciÃ³n
import { useTranslations } from '../../i18n/utils';

// 2. Importamos el OBJETO que contiene AMBOS idiomas
import allExperience from '../../data/experience.js';

// 3. Obtenemos el idioma actual y la funciÃ³n 't'
const { currentLocale } = Astro;
const lang = currentLocale as 'es' | 'en';
const t = useTranslations(lang);

// 4. Seleccionamos el ARRAY de experiencia del idioma correcto
//    (Usamos 'as any' para evitar el error de TypeScript si persiste)
const experienceHistory = (allExperience as any)[lang] || (allExperience as any).es;
---
<section id="experiencia" class="section-spacing bg-black/5 dark:bg-black/30">
  <div class="max-w-5xl mx-auto px-8">
    
    <h2 class="section-title text-slate-900 dark:text-slate-100">
      <span class="icon-emoji">ðŸ“ˆ</span> 
      {/* 5. Traducimos el tÃ­tulo */}
      {t('experience.title')}
    </h2>

    <div class="space-y-6">
      {/* 6. Comprobamos si experienceHistory es un array antes de mapear */}
      {experienceHistory && Array.isArray(experienceHistory) && experienceHistory.map(exp => (
        <div class="experience-card">
          <div class={`experience-glow experience-glow-${exp.colorTheme}`}></div>
          <div class="relative">
            
            <div class="flex justify-between items-start mb-3 flex-wrap gap-2">
              <h3 class="text-xl font-bold text-slate-800 dark:text-slate-100">{exp.title}</h3>
              <span class={`badge badge-${exp.colorTheme}`}>{exp.dates}</span>
            </div>
            
            <p class={`font-bold mb-4 text-lg text-${exp.colorTheme}-600 dark:text-${exp.colorTheme}-400`}>
              {exp.company}
            </p>
            
            <ul class="space-y-2 text-slate-600 dark:text-slate-300">
              {/* Comprobamos si descriptionItems es un array antes de mapear */}
              {exp.descriptionItems && Array.isArray(exp.descriptionItems) && exp.descriptionItems.map(item => (
                <li class="experience-item">
                  <span class="bullet-point"></span>
                  <span>{item}</span>
                </li>
              ))}
            </ul>

          </div>
        </div>
      ))}
    </div>

  </div>
</section>

